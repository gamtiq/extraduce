!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).extraduce={})}(this,(function(e){"use strict";var t,r="/#/extraduce|#|extra-action//";function o(e){return Boolean(e)&&e.type===r&&Array.isArray(e.payload)}function n(t,r){var n=r||{};"processActionArray"in n||(n.processActionArray=!0),"skipFalsyAction"in n||(n.skipFalsyAction=!0);var c=n.historySize;"number"!=typeof c&&(c=0);var i=c?[]:null;return function(r,a){var s=n.filterAction,p=n.onStepEnd,u=n.onStepStart,d=n.postreduce,f=n.postreduceValueIsState,A=n.prepareAction,y=n.prereduce,l=n.prereduceValueIsState,v=n.processActionArray,S=n.reducerExtraArgs,x=n.skipFalsyAction,h=n.transformAction,g=Array.isArray(a)&&v?a:o(a)?a.payload:[a],E=r,m=e.ProcessStep,b={sourceReducer:t,sourceState:r,sourceAction:a,state:E,history:i,stepSet:m,settings:n,data:n.data,stepStart:!1,stepEnd:!1};function P(e,t){t.step=e,"function"==typeof u&&(t.stepStart=!0,u(e,t),t.stepStart=!1)}function j(e,t){"function"==typeof p&&(t.stepEnd=!0,p(e,t),t.stepEnd=!1)}P(m.process,b);for(var k=0,F=g.length;k<F;k++){var I=g[k];if(b.action=I,b.actionIndex=k,b.firstAction=0===k,b.lastAction=k===F-1,b.validAction=!0,b.startState=b.reducedState=E,"function"==typeof A&&(P(m.prepareAction,b),I=b.action=A(I,b),j(m.prepareAction,b)),x&&!I?b.validAction=!1:"function"==typeof s&&(P(m.filterAction,b),b.validAction=s(I,b),j(m.filterAction,b)),b.validAction){var T=void 0;"function"==typeof h&&(P(m.transformAction,b),I=b.action=h(I,b),j(m.transformAction,b)),"function"==typeof y&&(P(m.prereduce,b),T=y(E,I,b),l&&(E=b.state=T),j(m.prereduce,b)),T=[E,I],S&&(P(m.reducerExtraArgs,b),T=T.concat("function"==typeof S?S(b):S),j(m.reducerExtraArgs,b)),P(m.reduce,b),E=b.state=t.apply(void 0,T),b.reducedState=E,j(m.reduce,b),"function"==typeof d&&(P(m.postreduce,b),T=d(E,I,b),f&&(E=b.state=T),j(m.postreduce,b)),i&&(P(m.history,b),i.length===c&&i.shift(),delete(T=Object.assign({time:(new Date).getTime()},b)).step,delete T.stepEnd,delete T.stepSet,delete T.stepStart,delete T.validAction,i.push(T),j(m.history,b))}}return j(m.process,b),E}}(t=e.ProcessStep||(e.ProcessStep={})).process="process",t.prepareAction="prepareAction",t.filterAction="filterAction",t.transformAction="transformAction",t.prereduce="prereduce",t.reducerExtraArgs="reducerExtraArgs",t.reduce="reduce",t.postreduce="postreduce",t.history="history",e.default=n,e.extraAction=function(){for(var e=[],t=0,o=arguments.length;t<o;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];e.push.apply(e,Array.isArray(n)?n:[n])}return{type:r,payload:e}},e.extraduce=n,e.getExtraActionType=function(){return r},e.isExtraAction=o,e.setExtraActionType=function(e){r=e},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=extraduce.umd.production.min.js.map
